<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width" />
    <base href="/" />
    <title>Tasks by user</title>
    <link rel="stylesheet" href="./css/bootstrap.css">
</head>
<body>
<header>
    <h1>Tasks by user</h1>
</header>
<main class="container mt-5">
    <div class="card border-0 shadow-lg" style="border-radius: 15px; background-color: #41464b">
        <div class="card-body">
            <table class="table table-striped table-bordered" id="tasksTable">
                <thead>
                <tr>
                    <th scope="col" data-key="col1">Task No.</th>
                    <th scope="col" data-key="col2">Title</th>
                    <th scope="col" data-key="col3">Due date</th>
                    <th scope="col" data-key="col4">Description</th>
                    <th scope="col" data-key="col5">Time estimate</th>
                    <th scope="col" data-key="col6">Tags</th>
                    <th scope="col" data-key="col7">Status</th>
                </tr>
                </thead>
                <tbody>
                <!-- Table rows will go here -->
                </tbody>
            </table>
        </div>
    </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        var data = [
            { col1: '1', col2: 'Create design', col3: '2023-12-13 12:00', col4: 'We need a design that we can discuss around...', col5: '2', col6: 'Design, CoOp', col7: 'Done' },
            { col1: '2', col2: 'Create first component', col3: '2023-12-18 12:00', col4: 'Create the first component used in the design', col5: '3', col6: 'Implement', col7: 'Ready for test' },
            { col1: '3', col2: 'Create components', col3: '2023-12-18 12:00', col4: 'Create components used in the design', col5: '3', col6: 'Implement', col7: 'Code review' },
            { col1: '4', col2: 'Apply design', col3: '2023-12-18 12:00', col4: 'Implement the design', col5: '3', col6: 'Design', col7: 'In progress' },
            { col1: '5', col2: 'Load content', col3: '2023-12-20 12:00', col4: 'Load content', col5: '3', col6: 'Design', col7: 'Blocked' },
            { col1: '6', col2: 'Deploy', col3: '2023-12-24 12:00', col4: 'Deploy everything', col5: '3', col6: 'Deploy', col7: 'ToDo' },
        ];

        var tbody = document.querySelector('tbody');
        var table = document.getElementById('tasksTable');

        function populateTable(data) {
            // Clear existing rows
            tbody.innerHTML = '';

            // Populate the table
            data.forEach(function(rowData) {
                var row = document.createElement('tr');

                for (var key in rowData) {
                    var cell = document.createElement('td');
                    var textContentSpan = document.createElement('span');

                    if (key === 'col7') {
                        textContentSpan.textContent = rowData[key];
                        setTaskStatusStyle(textContentSpan);
                        cell.appendChild(textContentSpan);
                    } else {
                        cell.textContent = rowData[key];
                    }

                    if (key !== 'col2' && key !== 'col4') {
                        cell.classList.add('text-center');
                    }

                    row.appendChild(cell);
                }

                tbody.appendChild(row);
            });
        }

        function setTaskStatusStyle(span) {
            if (span.textContent === 'In progress') {
                span.classList.add('inProgress');
            } else if (span.textContent === 'ToDo') {
                span.classList.add('toDo');
            } else if (span.textContent === 'Done') {
                span.classList.add('done');
            } else if (span.textContent === 'Ready for test') {
                span.classList.add('readyForTest');
            } else if (span.textContent === 'Blocked') {
                span.classList.add('blocked');
            } else if (span.textContent === 'Code review') {
                span.classList.add('codeReview');
            }
        }

        function sortTable(columnIndex) {
            var isAscending = true;

            var thClicked = table.querySelectorAll('th')[columnIndex];
            var key = thClicked.getAttribute('data-key');

            table.querySelectorAll('th').forEach(function(th, index) {
                if (index !== columnIndex) {
                    th.classList.remove('ascending', 'descending');
                }
            });

            if (thClicked.classList.contains('ascending')) {
                isAscending = false;
            }

            data.sort(function(a, b) {
                var valueA = a[key].toUpperCase();
                var valueB = b[key].toUpperCase();

                if (isAscending) {
                    return valueA.localeCompare(valueB);
                } else {
                    return valueB.localeCompare(valueA);
                }
            });

            thClicked.classList.toggle('ascending', isAscending);
            thClicked.classList.toggle('descending', !isAscending);

            populateTable(data);
        }



        // Initial table population
        populateTable(data);

        // Add click event listeners to table headers for sorting
        table.querySelectorAll('th').forEach(function(th, index) {
            th.addEventListener('click', function() {
                sortTable(index);
            });
        });
    });
</script>

<style>
    /* Your existing styles for task statuses */
    .inProgress {
        background-color: #198754;
        padding: 10px;
        border-radius: 8px;
        color: whitesmoke;
    }
    .readyForTest {
        background-color: #395a26;
        padding: 10px;
        border-radius: 8px;
        color: white;
    }
    .toDo {
        background-color: #0dcaf0;
        padding: 10px;
        border-radius: 8px;
    }
    .blocked {
        background-color: red;
        padding: 10px;
        border-radius: 8px;
        color: whitesmoke;
    }
    .codeReview {
        background-color: yellow;
        padding: 10px;
        border-radius: 8px;
    }
    .done {
        background-color: springgreen;
        padding: 10px;
        border-radius: 8px;
    }

    /* Styles for sorting indicators */
    th.ascending::after {
        content: '\25b2'; /* Unicode character for an upward arrow */
        margin-left: 5px;
    }
    th.descending::after {
        content: '\25bc'; /* Unicode character for a downward arrow */
        margin-left: 5px;
    }
</style>
</body>
</html>
